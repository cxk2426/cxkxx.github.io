<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>一念地图传送工具</title>
  <style>
  body {
  font-family: Arial, sans-serif;
  background-color: #f5f5f5;
}
#errorImage {
    display: block;
    margin: 0 auto;
    max-width: 80%; /* 根据需要调整图片的最大宽度 */
}
#mapSearchInput {
  padding: 10px;
  border: 1px solid #ccc;
  border-radius: 3px;
  width: 200px;
  margin-bottom: 10px;
  font-size: 0.8em;
}

button {
  padding: 8px 15px;
  border: none;
  border-radius: 3px;
  background-color: #0099FF;
  color: white;
  cursor: pointer;
  transition: background-color 0.3s ease;
  margin: 5px 0;
}

#customInput {
   max-width: 150px;
   font-size: 18px;
   margin-top: -10px;
}
.container {
  max-width: 600px;
  margin: 0 auto;
  padding: 20px;
}

input[type="text"] {
  padding: 10px;
  border: 1px solid #ccc;
  border-radius: 3px;
  width: 120px;
  font-size: 1.0em;
}

button:hover {
  background-color: #0099ff;
}

#resultArea {
  margin: 10px auto;
margin-top: -20px;
  border: 0px solid #ccc;
  border-radius: 3px;
  padding: 1px;
  width: 350px; 
  background-color: white;
}

#resultBox {
  margin-top: 10px;
  display: grid;
  grid-template-columns: 1fr;
  grid-template-rows: repeat(auto-fit, minmax(30px, auto));
  gap: 5px;
}

#resultBox div {
  background-color: #f9f9f9;
  padding: 5px;
  text-align: left;
  border-radius: 3px;
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}

#resultBox ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  grid-gap: 5px;
}

button {
  margin-left: 5px;
}
.button-group button {
  margin: -5px -1;
}

#shortcutButtonText {
  color: #0099ff;
  margin-top: -10px; /* 设置 margin-top 为负值，使元素向上移动 */
}

.copy-result-container {
  display: flex;
  align-items: center;
  margin-top: 5px;
}

.copy-result-container input[type="text"] {
  flex: 1;
  margin-right: 5px;
  background-color: #e6f7ff;
  border: none;
  padding: 10px 10px;
  font-size: 0.8em;
  text-align: left;
  border-radius: 3px;
  max-width: 100px;
}

.copy-result-container button {
  margin-left: 0;
}
.custom-input-container {
  display: flex;
  align-items: center;
  justify-content: space-between; /* 使按钮在水平方向上均匀分布，两端对齐 */
}

.custom-input-container button {
  margin-left: 5px;
  white-space: nowrap;
}

.custom-alert {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 300px;
    padding: 20px;
    background-color: #fff;
    border-radius: 5px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
    text-align: center;
}

.custom-alert p {
    margin-bottom: 15px;
}

.custom-alert button {
    padding: 8px 15px;
    border: none;
    border-radius: 3px;
    background-color: #0099FF;
    color: white;
    cursor: pointer;
}
#aiButton {
      margin-top: 10px;
    }

    #aiInput {
      width: 200px;
      margin-top: 10px;
    }

    #aiAlert {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 200px;
      padding: 15px;
      background-color: #fff;
      border-radius: 5px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
      text-align: center;
    }
  </style>
</head>
<img id="errorImage" src="https://fs-im-kefu.7moor-fs1.com/ly/4d2c3f00-7d4c-11e5-af15-41bf63ae4ea0/1735228252953/Image_557751751358951.jpg" alt="贝利亚奥特曼" style="display: none;">
<body style="background-color: #f0f0f0; background-image: url('https://fs-im-kefu.7moor-fs1.com/ly/4d2c3f00-7d4c-11e5-af15-41bf63ae4ea0/1734591713155/Image_1729705974323.jpg');background-repeat: no-repeat; background-size: cover;">
  <div class="container">
    <h1 style="font-family: 'Brush Script MT', cursive; color: #336699;">一念地图
      <select id="mapTypeMenu">
        <option value="allLocations">查看全图</option>
        <option value="customPortals">查看仙居</option>
      </select>
      <button onclick="showLocations()">全图 or 仙居</button>
    </h1>
    <button onclick="goToImage()">地图图片</button>
    <select id="copyOptionSelect">
  <option value="npc任务">npc</option>
  <option value="打 boss">打 boss</option>
 <option value="灵兽捕捉 4">灵兽捕捉</option>
  <option value="进入藏宝地">进入藏宝地</option>
</select>
     <select id="portalTypeMenu">
      <option value="portalOne">天四以上传送点</option>
      <option value="portalTwo">天四以下传送点</option>
    </select>
     <button id="findNearestPortalButton" onclick="findNearestPortal()">查找最近传送点</button>
    <button onclick="switchPortal()">切换传送点</button>
    <button onclick="goToTreasureMap()">查藏宝地</button>
    <input type="text" id="locationInput" placeholder="输入地点名称" style="width: 100px; height: 30px; font-size: 14px; display: inline-block;">
    <input type="password" id="passwordInput" placeholder="输入密码验证" style="width: 83px; height: 20px; font-size: 16px;">
    <button onclick="openDoubaoPage()">打开豆包</button>
       <div class="custom-input-container">
      <textarea id="customInput" rows="2" placeholder="添加仙居（换行）"></textarea>
      <button onclick="addCustomPortals()">添加仙居</button>
      <button onclick="addAllPortals()">添加仙居库</button>
    </div>
    <div id="customAlert" class="custom-alert">
      <p id="alertMessage"></p>
      <button onclick="closeAlert()">确定</button>
    </div>
    </div>
  <div id="addedPortalsList"></div>
  <div id="aiAlert" class="custom-alert">
  </div>
  <div id="resultArea">
    <div id="resultBox"></div>
  </div>
  </div>
  <script>
  document.getElementById('copyOptionSelect').addEventListener('change', function() {
  const selectedOption = this.value;
  const textarea = document.createElement('textarea');
  textarea.value = selectedOption;
  document.body.appendChild(textarea);
  textarea.select();
  try {
    document.execCommand('copy');
    console.log('已复制到剪贴板');
    showAlert('复制成功：' + selectedOption, true);
  } catch (err) {
    console.error('复制失败: ', err);
    showAlert('复制失败：' + selectedOption + '，请重试。', false);
  }
  document.body.removeChild(textarea);
});
    const portals = ["冰雪洞窟", "云海之上", "天外天", "赤炎峰", "龙骨荒原", "玄光古海", "花开碧霄岛", "南岳青云峰", "玄龙潜渊", "仙岛深处", "遥远星域", "现代城市", "山洞内", "修炼室", "无尽试炼之域", "神秘秘境", "古仙战场", "虚空试炼场", "智慧星球", "灵脉力场", "宇宙深渊", "天界裁决殿", "风祝山巅", "小镇古塔", "幽深秘境", "时空藤谷", "时气遗迹", "泰山顶", "瀑布旁", "银白禁地", "雷霆峰", "苍生之地", "未知之地", "鸿蒙宇宙", "宗门广场", "古老洞窟"];
    const maxPerRow = 5; // 每行最多显示的数量
    let currentRow = [];
    portals.forEach((portal, index) => {
      const p = document.createElement('p');
      p.textContent = portal;
      p.style.fontSize = "0px";
      p.style.lineHeight = "0.8em";
      p.style.color = "rgba(0, 0, 0, 0)";
      currentRow.push(p);
      if (currentRow.length === maxPerRow || index === portals.length - 1) {
        const rowDiv = document.createElement('div');
        currentRow.forEach(p => rowDiv.appendChild(p));
        document.getElementById('addedPortalsList').appendChild(rowDiv);
        currentRow = [];
      }
    });
    
     function goToImage() {
      window.location.href = "image.html";
    }

    function openDoubaoPage() {
      window.location.href = "doubao.html";
    }

    window.showAlert = function (message) {
      const alertDiv = document.getElementById('customAlert');
      const alertMessage = document.getElementById('alertMessage');
      alertMessage.textContent = message;
      alertDiv.style.display = 'block';
    }

    window.closeAlert = function () {
      const alertDiv = document.getElementById('customAlert');
      alertDiv.style.display = 'none';
    }

    function closeAlert() {
      const alertDiv = document.getElementById('customAlert');
      alertDiv.style.display = 'none';
    }

    function addAllPortals() {
      const portalsElements = addedPortalsList.querySelectorAll('p');
      portalsElements.forEach(function (element) {
        const portal = element.textContent;
        if (portal &&!customPortals.includes(portal)) {
          customPortals.push(portal);
        }
      });
      showAlert('所有仙居已成功添加到自定义传送点列表。');
      console.log('所有仙居已添加到自定义传送点列表。');
    }

    function copyenter() {
      var textToCopy = "进入藏宝地";
      const textarea = document.createElement('textarea');
      textarea.value = textToCopy;
      document.body.appendChild(textarea);
      textarea.select();
      try {
        document.execCommand('copy');
        console.log('新的复制按钮：已复制进入藏宝地内容成功');
        showAlert('复制成功：进入藏宝地');
      } catch (err) {
        console.error('新的复制按钮：复制失败: ', err);
        showAlert('复制进入藏宝地失败');
      }
      document.body.removeChild(textarea);
    }

    function copyTask() {
      var textToCopy = "npc任务";
      const textarea = document.createElement('textarea');
      textarea.value = textToCopy;
      document.body.appendChild(textarea);
      textarea.select();
      try {
        document.execCommand('copy');
        console.log('新的复制按钮：已复制npc任务内容成功');
        showAlert('复制成功：npc任务');
      } catch (err) {
        console.error('新的复制按钮：复制失败: ', err);
        showAlert('复制npc任务失败');
      }
      document.body.removeChild(textarea);
    }

    function copyAnimals() {
      var textToCopy = "灵兽捕捉 4";
      const textarea = document.createElement('textarea');
      textarea.value = textToCopy;
      document.body.appendChild(textarea);
      textarea.select();
      try {
        document.execCommand('copy');
        console.log('新的复制按钮：复制内容成功');
        showAlert('复制成功：灵兽捕捉 4');
      } catch (err) {
        console.error('新的复制小题：复制失败: ', err);
        showAlert('复制灵兽捕捉 4失败');
      }
      document.body.removeChild(textarea);
    }

    function copyBossText() {
      const textToCopy = "打boss";
      const textarea = document.createElement('textarea');
      textarea.value = textToCopy;
      document.body.appendChild(textarea);
      textarea.select();
      try {
        document.execCommand('copy');
        console.log('打boss文字已复制到剪贴板');
        showAlert('复制成功：打boss');
      } catch (err) {
        console.error('复制失败: ', err);
        showAlert('复制失败');
      }
      document.body.removeChild(textarea);
    }

    function copyToClipboard(text) {
      const textarea = document.createElement('textarea');
      textarea.value = text;
      document.body.appendChild(textarea);
      textarea.select();
      try {
        document.execCommand('copy');
        console.log('已复制到剪贴板');
        showAlert('复制成功！', true);
      } catch (err) {
        console.error('复制失败: ', err);
        showAlert('复制失败，请重试。', false);
      }
      document.body.removeChild(textarea);
    }

    function clearCustomPortalsButton() {
      var addedPortalsList = document.getElementById('addedPortalsList');
      addedPortalsList.innerHTML = "";
      console.log('已添加仙居已清空');
    }

    function showLocations() {
      const option = document.getElementById('mapTypeMenu').value;
      if (option === 'allLocations') {
        showAllLocations();
      } else if (option === 'customPortals') {
        showCustomPortals();
      }
    }

    function showAllLocations() {
      const inputLocation = document.getElementById('locationInput').value.trim();
      if (inputLocation === "") {
        const resultContainer = document.createElement('div');
        resultContainer.id = 'matchingListContainer';
        const matchingList = document.createElement('ul');
        matchingList.id = 'matchingList';
        const allLocations = locations;
        allLocations.forEach((location, index) => {
          const listItem = document.createElement('li');
          listItem.textContent = `${location}(${index + 1})`;
          listItem.addEventListener('click', () => {
            const locationWithoutNumber = location;
            document.getElementById('locationInput').value = locationWithoutNumber;
            findNearestPortal();
            document.getElementById('findNearestPortalButton').click();
          });
          matchingList.appendChild(listItem);
        });
        resultContainer.appendChild(matchingList);
        const result = document.getElementById('resultBox');
        result.innerHTML = '';
        result.appendChild(resultContainer);
      } else {
        const firstChar = inputLocation.charAt(0);
        const uniqueFirstChars = [...new Set(locations.map(location => location.charAt(0)))];
        if (uniqueFirstChars.includes(firstChar) && document.getElementById('findNearestPortalButton')) {
          findNearestPortalForFirstChar(firstChar);
        } else {
          const resultContainer = document.createElement('div');
          resultContainer.textContent = '没有以该首字开头的地点。';
          const result = document.getElementById('resultBox');
          result.innerHTML = '';
          result.appendChild(resultContainer);
        }
      }
    }

    function showCustomPortals() {
    const resultContainer = document.createElement('div');
    resultContainer.id ='matchingListContainer';
    const matchingList = document.createElement('ul');
    matchingList.id ='matchingList';
    const allLocations = customPortals;
    allLocations.forEach((location, index) => {
        const listItem = document.createElement('li');
        listItem.textContent = `${location}(${index + 1})`;
        listItem.addEventListener('click', () => {
            const locationWithoutNumber = location;
            const locationInput = document.getElementById('locationInput');
            if (locationInput) {
                locationInput.value = locationWithoutNumber;
                findNearestPortal();
                const findNearestPortalButton = document.getElementById('findNearestPortalButton');
                if (findNearestPortalButton) {
                    findNearestPortalButton.click();
                }
            }
        });
        matchingList.appendChild(listItem);
    });
    resultContainer.appendChild(matchingList);
    const result = document.getElementById('resultBox');
    if (result) {
        result.innerHTML = '';
        result.appendChild(resultContainer);
    }
}

function receiveLocationFromTreasureMap(location) {
    const locationInput = document.getElementById('locationInput');
    if (locationInput) {
        locationInput.value = location;
    }
}

function goToTreasureMap() {
    const newWindow = window.open("宝图.html", "_blank", "noopener=yes");
    // 假设新窗口有一个函数sendDataToParent用于传递数据
    newWindow.onload = function () {
        newWindow.sendDataToParent = function (data) {
            window.postMessage(data, '*');
        };
    };
    window.addEventListener('message', function (event) {
        // 处理从新窗口传来的数据
        if (event.origin === newWindow.origin) {
            // 这里可以根据实际数据做相应处理
        }
    });
}

document.addEventListener('DOMContentLoaded', function () {
    try {
        const urlParams = new URLSearchParams(window.location.search);
        const locationFromTreasureMap = urlParams.get('location');
        if (locationFromTreasureMap) {
            receiveLocationFromTreasureMap(locationFromTreasureMap);
        }
        const location = localStorage.getItem('treasureMapLocation');
        if (location) {
            const destinationInput = document.getElementById('destinationInput');
            if (destinationInput) {
                destinationInput.value = location;
                localStorage.removeItem('treasureMapLocation');
            }
        }
        const isLoggedIn = localStorage.getItem('isLoggedIn');
        if (isLoggedIn === 'true') {
            const storedPassword = localStorage.getItem('password');
            const passwordInput = document.getElementById('passwordInput');
            if (passwordInput) {
                passwordInput.value = storedPassword;
            }
        }
    } catch (error) {
        console.error('Error accessing local storage or other operations:', error);
    }
});
    
   </script>
  <script>
    // 假设的地点名称数组（按顺序排列）
    const locations = ["七星山脉",
             '七重天界',
            '万丈海沟',
            '万丈瀑布下',
            '万剑平原',
            '万灵圣地',
            '万里冰封之地',
            '三十三重天',
            '不周山',
            '东胜神洲',
            '九天之上',
            '九天雷池',
            '九幽',
            '九幽冥河',
            '九幽寒潭',
            '九幽深渊',
            '九幽渊',
            '云梦泽',
            '云海之上',
            '云海涧',
            '云霄玉台',
            '五台山',
            '人间意',
            '仙境图书馆',
            '仙宫',
            '仙岛深处',
            '仙梦花海',
            '仙气汇聚之地',
            '仙泉旁',
            '仙灵果树',
            '仙界主峰',
            '仙界秘境深处',
            '仙界边界',
            '仙界遗迹内部',
            '仙草生长地',
            '仙鹤峰',
            '仙龙宝塔',
            '伏龙潭',
            '修仙界边境',
            '修炼室',
            '修真界战场',
            '光华净海',
            '光影幽境',
            '光明之谷',
            '光明洞窟',
            '光明顶',
            '光澜深渊',
            '光焰群岚',
            '光鸣之野',
            '光辉金塔',
            '八十八角真阳楼',
            '冥界',
            '冰封古城',
            '冰焰绝地',
            '冰雪山脉',
            '冰雪洞窟',
            '冰魄寒域',
            '凡间小镇',
            '凤栖谷',
            '剑气长城',
            '北寒冰原',
            '千年古道',
            '千年秘境',
            '千禧年科技学院',
            '南云灵墟',
            '南天幽域',
            '南岭苍霄',
            '南岳青云峰',
            '南极',
            '南渊绝地',
            '南焰天宫',
            '南玄龙潭',
            '南荒秘境',
            '南辰幻境',
            '南风仙谷',
            '原初之星',
            '古仙战场',
            '古代仙境',
            '古代遗迹',
            '古城遗址',
            '古城遗迹',
            '古墓内部',
            '古墓内部炼丹室',
            '古寺',
            '古庙中',
            '古族遗址',
            '古月仙岛',
            '古老洞窟',
            '古老湖泊',
            '古老秘境',
            '古老遗迹',
            '古荒秘境',
            '古药谷',
            '古道仙境',
            '命运之塔',
            '命运之巅',
            '命运神殿',
            '喜烛殿',
            '圣地之心',
            '地底洞穴',
            '地心',
            '地火深渊',
            '坊市',
            '堕日岭',
            '多维交叉核心',
            '夜月之岛',
            '夜魇山脉',
            '大型扫地机器人',
            '大罗天',
            '天上天宫',
            '天剑岭',
            '天台',
            '天台山',
            '天地异变现场',
            '天域门',
            '天境幻阵',
            '天墟古林',
            '天外天',
            '天山之巅',
            '天崖灵洞',
            '天春之境',        
            '天机阁',
            '天枢之地',
            '天池',
            '天池圣湖',
            '天池岛',
            '天河之上',
            '天瀑灵崖',
            '天灵洞府',
            '天灾之域',
            '天玄塔',
            '天玑星域',
            '天璇峰',
            '天界中殿',
            '天界之门',
            '天界裁决殿',
            '天空之城',
            '天绝崖',
            '天翔崖',
            '天道之巅',
            '天道试炼场',
            '天门山',
            '天际地平线',
            '天雷台',
            '天雷浩瀚',
            '天雷绝崖',
            '太上忘情谷',
            '太乙仙宫',
            '太初云墟',
            '太初古界',
            '太古遗迹',
            '太清仙境',
            '太湖中心',
            '太虚幻境',
            '太虚谷',
            '奇异沙漠',
            '奈何崖',
            '奈何桥',
            '妖族圣地',
            '学园都市',
            '宇宙中枢',
            '宇宙枢纽',
            '宇宙法则之心',
            '宇宙深渊',
            '宇宙混沌边缘',
            '宇宙结界交汇点',
            '宇宙边界',
            '宗门丹房',
            '宗门内院',
            '宗门后山',
            '宗门大门',
            '宗门山门',
            '宗门山门前',
            '宗门广场',
            '宗门比武场',
            '宗门演武场',
            '宗门灵兽山',
            '宗门藏书阁',
            '宴会大厅',
            '家中',
            '密林深处',
            '寒冰峡谷',
            '寒冰林海',
            '寒月峰',
            '寒月海',
            '寒潭',
            '寒潭之畔',
            '寒霜雪域',
            '封印之地',
            '小汤圆神界',
            '小河旁',
            '小镇古塔',
            '居所',
            '居所密室',
            '居所门外',
            '山中',
            '山中密林',
            '山中洞府',
            '山巅',
            '山村剑冢',
            '山林小径',
            '山洞内',
            '山洞深处',
            '山海经',
            '山谷深处',
            '山谷灵泉',
            '山门外',
            '山间奇泉',
            '山顶',
            '巨树上的蛇巢',
            '巨石上的蛇符',
            '师门内部',
            '帝一宫',
            '常盘台',
            '平行世界遗迹',
            '幻境之海',
            '幻影岛',
            '幻月平川',
            '幻海迷宫',
            '幻灵山谷',
            '幻灵秘境',
            '幽冥洞',
            '幽冥边界',
            '幽冥鬼域',
            '幽冥鬼谷',
            '幽暗星域',
            '幽梦森林',
            '幽深秘境',
            '幽深竹海',
            '异界密林',
            '异界深处',
            '异界秘境',
            '异界遗迹',
            '归墟之地',
            '归墟海眼',
            '往世乐土',
            '心动山谷',
            '心动天宫',
            '忘川河畔',
            '忘忧谷',
            '扶摇山谷',
            '断魂崖',
            '旋转的时间流沙',
            '无名仙地',
            '无名仙山',
            '无名秘境',
            '无垠空域',
            '无尽剑冢',
            '无尽幻境',
            '无尽海域',
            '无尽深渊',
            '无尽试炼之域',
            '无极玄宫',
            '无极长河',
            '无量仙河',
            '无量界域',
            '日落湾',
            '时代商会',
            '时代灵场',
            '时光之塔',
            '时光古道',
            '时光古阵',
            '时光流转之地',
            '时光秘池',
            '时光竹林',
            '时分古林',
            '时分灵巢',
            '时刻秘径',
            '时常狂风呼啸的山巅',
            '时气遗迹',
            '时流瀑布',
            '时空之涡',
            '时空交汇点',
            '时空凝滞沙漠',
            '时空山崖',
            '时空核心',
            '时空洞窟',
            '时空灵塔',
            '时空灵谷',
            '时空藤谷',
            '时空裂缝',
            '时而流水潺潺的古桥',
            '时节天穹',
            '时节灵地',
            '时辰灵塔',
            '时间天池',
            '时间幻林',
            '时间溪流',
            '时间灵坳',
            '时隐深林',
            '时雨奇境',
            '时雨幽谷',
            '昆仑墟',
            '星月原',
            '星河古路',
            '星空下',
            '星空中',
            '星空之巅',
            '星空秘境',
            '星辉沼泽',
            '星辰古殿',
            '星辰坞',
            '星辰大海',
            '星辰洞府内部',
            '星辰海',
            '星辰湖',
            '春之岛',
            '春之川',
            '春之谷',
            '春华山脉',
            '春华秘境',
            '春境天池',
            '春日仙林',
            '春晓平原',
            '春晖仙境',
            '春晖谷',
            '春樱之森',
            '春泽之域',
            '春满灵池',
            '春灵谷',
            '春蕾之池',
            '春野仙域',
            '春雨岛',
            '春霞峰',
            '春韵谷地',
            '春风洞天',
            '春风渡',
            '春风溪谷',
            '晶光遗迹',
            '智慧星球',
            '暗影荒原',
            '暗潮裂谷',
            '暗物质核心区域',
            '暮影林',
            '暮霭云川',
            '曦光之境',
            '曦尘洞窟',
            '曦晨星海',
            '曦月之泉',
            '曦月山脉',
            '曦涛大海',
            '曦澜海域',
            '曦灵谷',
            '曦瑶湖',
            '曦羽之岛',
            '曦风荒原',
            '月光台',
            '月光秘境',
            '月华谷',
            '月影幽谷',
            '月影湖',
            '月影荒原',
            '月舞平原',
            '月魂山',
            '未来世界',
            '未知之地',
            '村中古井',
            '极东之境',
            '极北冰原',
            '极寒之巅',
            '极寒冰川',
            '桃源',
            '桃花坞',
            '桃花春谷',
            '梦回谷',
            '梦境',
            '梦境中的蛇域',
            '梦境之地',
            '梦灵湖泊',
            '森林中',
            '武境',
            '武当山',
            '毒沼',
            '民宅',
            '永恒云巅',
            '江上',
            '河畔渔家',
            '法则交错点',
            '法界之顶',
            '泪洒小河边',
            '泰山顶',
            '洞府丹房',
            '洞府深处',
            '流光秘海',
            '浮光岛',
            '浮空岛',
            '海域九绝岛',
            '海天幻境',
            '海底蛇窟',
            '海星神宫',
            '海渊幽谷',
            '海潮万刹崖',
            '海澜琼阁',
            '海灵仙洲',
            '海炼苍穹岛',
            '海音浮屠',
            '海魄禁渊',
            '涂山',
            '深山之中',
            '深林内部',
            '深渊之核',
            '深渊核心',
            '混元虚海',
            '混沌深渊',
            '清幽山谷',
            '清风涧',
            '渡劫台',
            '渡劫峰',
            '湖底的蛇宫',
            '湖心小岛',
            '湖泊畔',
            '瀑布旁',
            '火山内部',
            '火山口',
            '火焰山',
            '灵墟谷',
            '灵山古道',
            '灵山寺',
            '灵山秘境',
            '灵岳天峰',
            '灵春山庄',
            '灵气枯竭之地',
            '灵气漩涡中心',
            '灵气风暴中心',
            '灵泉之源',
            '灵泉旁',
            '灵泉谷',
            '灵湖',
            '灵灼林',
            '灵田中的石底',
            '灵界',
            '灵界秘境',
            '灵石矿脉',
            '灵纹之岛',
            '灵脉之巅',
            '灵脉力场',
            '灵脉所在之地',
            '灵脉深处',
            '灵脉源头',
            '灵药山',
            '灵药禁地',
            '灵药谷',
            '灵风峡',
            '炎龙窟',
            '炼丹房',
            '炼器山',
            '烈焰火山',
            '烈焰蛇火山',
            '烟雨仙渺',
            '焚天荒原',
            '焰空天域',
            '熔岩石桥',
            '牛牛神界',
            '狐狸窝',
            '玄光古海',
            '玄冰深渊',
            '玄冰绝渊',
            '玄华仙峰',
            '玄天古矿',
            '玄天圣域',
            '玄天心湖',
            '玄天灵峰',
            '玄天秘境',
            '玄影幻城',
            '玄星秘岛',
            '玄月幽谷',
            '玄灵秘境',
            '玄荼仙宫',
            '玄铁矿脉',
            '玄霄星域',
            '玄魂秘地',
            '玄龙潜渊',
            '玉兰瑶岛',
            '玉华秘境',
            '玉山碧落谷',
            '玉海归墟',
            '玉清天池',
            '玉灵幽渊',
            '玉烟幻界',
            '玉翠琼台',
            '玉虚宫',
            '玉衡仙宫',
            '玉辰玄峰',
            '现代城市',
            '琴断弦奈何',
            '瑶光仙湖',
            '瑶光川',
            '瑶春山脉',
            '瑶池仙境',
            '瑶池天镜',
            '田间小屋',
            '白云城',
            '白泽秘境',
            '白玉京',
            '白蛇之境',
            '白骨岭',
            '知识之海',
            '矿脉入口',
            '破云山',
            '碧春潭',
            '碧海湾',
            '碧海潮生岛',
            '碧落之港',
            '碧落渊',
            '神兵遗迹',
            '神兽聚集之地',
            '神兽聚集地',
            '神兽试炼场',
            '神弃之地',
            '神木林',
            '神木森林',
            '神武大殿',
            '神灵降临之地',
            '神秘山洞',
            '神秘秘境',
            '神秘空岛',
            '神蛇秘谷',
            '神魂之境',
            '神魔战场',
            '禁地内部',
            '秘境内部',
            '秘境深处',
            '秘密拍卖场',
            '秘银荒原',
            '空无一物的「世界」',
            '空间裂缝边缘',
            '符咒草原',
            '紫电苍穹',
            '紫阳丘',
            '紫霄峰',
            '紫霄雷池',
            '紫霞岭',
            '紫霞洞天',
            '红莲池',
            '红薯',
            '绝世悬崖',
            '绝云峰',
            '绝影天涯',
            '维度之网',
            '翠微崖',
            '翠春林',
            '翠春河畔',
            '翠竹云谷',
            '翠蛇之池',
            '耿',
            '肥肥崖崖底',
            '能量转化站',
            '至尊洞天',
            '花开碧霄岛',
            '花影琼台',
            '花月秘境',
            '花海瑶池',
            '花灵仙谷',
            '花神忘川',
            '花舞幽冥渊',
            '花若天央宫',
            '花落无痕涧',
            '花魂禁地',
            '苍梧岭',
            '苍生之地',
            '苍穹遗迹',
            '苍穹雪原',
            '苍茫天域',
            '草原深处',
            '荒古山脉',
            '荒古废墟',
            '荒古战场',
            '荒古深渊',
            '荒古禁地',
            '荒古遗址',
            '荒漠绿洲',
            '荒野深处',
            '落月崖',
            '落霞大平原',
            '落霞谷',
            '落魄山',
            '蓬莱仙山',
            '蓬莱仙屿',
            '蓬莱仙岛',
            '藏书殿',
            '藏书阁',
            '藏经阁',
            '虚影森林',
            '虚无之境',
            '虚无缥缈之域',
            '虚无谷',
            '虚空密境',
            '虚空混沌之地',
            '虚空试炼场',
            '蛇之小岛',
            '蛇尾竹林',
            '蛇影山谷',
            '蛇沙滩',
            '蛇窟洞天',
            '蛇纹迷宫',
            '蛇蜿幽谷',
            '蛇行小溪',
            '蛇鳞森林',
            '蛮荒之境',
            '蛇蜒迷林',
            '血月平原',
            '血月沙漠',
            '血海秘境',
            '访市',
            '诗云幻境',
            '诗华仙岛',
            '诗影幽谷',
            '诗月天台',
            '诗梦琼阁',
            '诗灯古林',
            '诗花明镜潭',
            '诗雨归峰',
            '诗音绝壁',
            '诗魂幻渊',
            '诸天试炼场',
            '赤炎峰',
            '赤焰崖',
            '赤血魔渊',
            '赤霄禁地',
            '赤霞峰',
            '赤龙窟',
            '超光速门',
            '轮回幻境',
            '辉光沼泽',
            '边境战场',
            '边际星球',
            '远古遗址深处',
            '远古遗迹',
            '远古遗迹深处',
            '远山药园',
            '迷雾森林',
            '迷雾禁地',
            '通天梧桐林',
            '遗忘之地',
            '遥远星域',
            '都市街头',
            '金光圣谷',
            '金光川',
            '金烁洞窟',
            '金砂沙漠',
            '金羽林地',
            '金耀山脉',
            '金蛇沙漠',
            '金辉平原',
            '金银岛',
            '金霞之岛',
            '金鳌岛',
            '金龙之泉',
            '银叶古树',
            '银月之森',
            '银月湖',
            '银杉古林',
            '银杏仙台',
            '银杏仙谷',
            '银河天桥',
            '银河星海',
            '银灰秘境',
            '银白冰原',
            '银白圣殿',
            '银白寒潭',
            '银白山脉',
            '银白禁地',
            '银白雪原',
            '银色天桥',
            '银色幻境',
            '银色海湾',
            '银色龙潭',
            '银花幻境',
            '银铃幻境',
            '银铃幽谷',
            '铸剑山庄',
            '铸魂山',
            '镜像世界',
            '镜月湖',
            '镜湖深渊',
            '长生天',
            '长生界',
            '长生界之门',
            '长生界湖',
            '闭关室',
            '闭关洞府',
            '阴阳交界',
            '阴阳谷',
            '阴阳道场',
            '阴风峡谷',
            '阿比茨之渊',
            '陨石坠落之地',
            '隐秘古遗迹',
            '雪山洞窟',
            '雪花山',
            '雷泽原',
            '雷神之岛',
            '雷蛇之谷',
            '雷雨山',
            '雷霆峰',
            '雷霆崖',
            '雷霆谷地',
            '雷鸣崖',
            '雾丘',
            '青云山',
            '青云峰',
            '青春古道',
            '青灵仙峰',
            '青羽山',
            '青莲池',
            '青莲秘境',
            '青莲道场',
            '青铜仙殿',
            '青霞平原',
            '青龙潭',
            '风华绝代',
            '风啸雪岭',
            '风岚天涯',
            '风影秘谷',
            '风暴之巅',
            '风月谷',
            '风涌绿洲',
            '风烛之森',
            '风痕石原',
            '风祝山巅',
            '风语流砂',
            '风辰荒岛',
            '风铃云径',
            '飞霞琼阁',
            '高山之巅',
            '高空云端',
            '魔影山脉',
            '魔法密林',
            '魔渊岛',
            '魔焰峡谷',
            '魔焰沼泽',
            '魔窟深处',
            '鸿蒙宇宙',
            '鸿蒙虚空',
            '黄河旁',
            '黄金之域',
            '黑与白的失落群星',
            '黑暗大殿',
            '黑风涧',
            '龙影山脉',
            '龙族圣地',
            '龙族遗迹',
            '龙潭渊',
            '龙穴深处',
            '龙脉源头',
            '龙门关',
            '龙骨荒原',
            "龙骨遗迹"]   
        // 传送点
  let isFirstPasswordCheck = true; // 用于标记是否是第一次密码验证
let hasSearched = false; // 用于标记是否已经进行过查找操作

// 自定义传送点（仙居）数组
let customPortals = [];
let currentPortals = []; // 用于存储当前使用的传送点集合
// 用于存储第一种传送点的数组
let portalsOne = [];
// 用于存储第二种传送点的数组
let portalsTwo = [];
// 从locations数组中提取传送点并存入portalsOne和portalsTwo
function setupPortals() {
    let index = 0;
    // 提取第一种传送点（每五十个取一个）
    while (index < locations.length) {
        portalsOne.push(locations[index]);
        index += 50;
    }
    // 提取第二种传送点（每四十个取一个，从第1个位置开始）
    index = 0;
    while (index < locations.length) {
        portalsTwo.push(locations[index]);
        index += 40;
    }
}

// 调用函数设置传送点
setupPortals();

console.log("Portals One:", portalsOne);
console.log("Portals Two:", portalsTwo);

function switchToPortalOne() {
    currentPortals = portalsOne;
    document.getElementById('resultBox').innerHTML = ''; // 清空结果显示区域
    let portalsOneContent = '天四以上传送点：<br>';
    portalsOne.forEach(portal => {
        portalsOneContent += `${portal}<br>`;
    });
    const resultBox = document.getElementById('resultBox');
    if (resultBox) {
        resultBox.innerHTML = portalsOneContent;
    }
    // 创建提示信息元素
    const tipElement = document.createElement('div');
    tipElement.textContent = '已切换到天四以上传送点。';
    tipElement.style.position = 'fixed';
    tipElement.style.top = '10px';
    tipElement.style.right = '10px';
    tipElement.style.backgroundColor = 'rgba(0, 0, 0, 0.7)';
    tipElement.style.color = 'white';
    tipElement.style.padding = '5px 10px';
    tipElement.style.borderRadius = '3px';
    // 将提示信息元素添加到页面中
    document.body.appendChild(tipElement);
    // 设置一段时间后自动隐藏提示信息
    setTimeout(() => {
        document.body.removeChild(tipElement);
    }, 3000); // 3秒后隐藏提示信息
}

function switchToPortalTwo() {
    currentPortals = portalsTwo;
    document.getElementById('resultBox').innerHTML = ''; // 清空结果显示区域
    let portalsTwoContent = '天四以下传送点：<br>';
    portalsTwo.forEach(portal => {
        portalsTwoContent += `${portal}<br>`;
    });
    const resultBox = document.getElementById('resultBox');
    if (resultBox) {
        resultBox.innerHTML = portalsTwoContent;
    }
    const tipElement = document.createElement('div');
    tipElement.textContent = '已切换到天四以下传送点。';
    tipElement.style.position = 'fixed';
    tipElement.style.top = '10px';
    tipElement.style.right = '10px';
    tipElement.style.backgroundColor = 'rgba(0, 0, 0, 0.7)';
    tipElement.style.color = 'white';
    tipElement.style.padding = '5px 10px';
    tipElement.style.borderRadius = '3px';
    document.body.appendChild(tipElement);
    setTimeout(() => {
        document.body.removeChild(tipElement);
    }, 2000);
}
function switchPortal() {
  const selectedPortalType = document.getElementById('portalTypeMenu').value;
  if (selectedPortalType === 'portalOne') {
    currentPortals = portalsOne;
    document.getElementById('resultBox').innerHTML = '';
    let portalsOneContent = '天四以上传送点：<br>';
    portalsOne.forEach(portal => {
      portalsOneContent += `${portal}<br>`;
    });
    const resultBox = document.getElementById('resultBox');
    if (resultBox) {
      resultBox.innerHTML = portalsOneContent;
    }
    const tipElement = document.createElement('div');
    tipElement.textContent = '已切换到天四以上传送点。';
    tipElement.style.position = 'fixed';
    tipElement.style.top = '10px';
    tipElement.style.right = '10px';
    tipElement.style.backgroundColor = 'rgba(0, 0, 0, 0.7)';
    tipElement.style.color = 'white';
    tipElement.style.padding = '5px 10px';
    tipElement.style.borderRadius = '3px';
    document.body.appendChild(tipElement);
    setTimeout(() => {
      document.body.removeChild(tipElement);
    }, 3000);
  } else if (selectedPortalType === 'portalTwo') {
    currentPortals = portalsTwo;
    document.getElementById('resultBox').innerHTML = '';
    let portalsTwoContent = '天四以下传送点：<br>';
    portalsTwo.forEach(portal => {
      portalsTwoContent += `${portal}<br>`;
    });
    const resultBox = document.getElementById('resultBox');
    if (resultBox) {
      resultBox.innerHTML = portalsTwoContent;
    }
    const tipElement = document.createElement('div');
    tipElement.textContent = '已切换到天四以下传送点。';
    tipElement.style.position = 'fixed';
    tipElement.style.top = '10px';
    tipElement.style.right = '10px';
    tipElement.style.backgroundColor = 'rgba(0, 0, 0, 0.7)';
    tipElement.style.color = 'white';
    tipElement.style.padding = '5px 10px';
    tipElement.style.borderRadius = '3px';
    document.body.appendChild(tipElement);
    setTimeout(() => {
      document.body.removeChild(tipElement);
    }, 2000);
  }
}

window.onload = function () {
    // 检查是否从登录页面跳转过来
    const isLoggedIn = localStorage.getItem('isLoggedIn');
    if (isLoggedIn === 'true') {
        const storedPassword = localStorage.getItem('password');
        if (storedPassword) {
            document.getElementById('passwordInput').value = storedPassword;
        }
    }
}

function findNearestPortal() {
    const inputPassword = document.getElementById('passwordInput').value;
    const correctPassword = "鸿蒙666";
    if (inputPassword!== correctPassword) {
        document.getElementById('errorImage').style.display = "block";
        showAlert("密码错误，请重新输入\n( ⸝⸝⸝•_•⸝⸝⸝ )♡( ⸝⸝⸝•_•⸝⸝⸝ )♡\n( ⸝⸝⸝•_•⸝⸝⸝ )♡( ⸝⸝⸝•_•⸝⸝⸝ )♡\n( ⸝⸝⸝•_•⸝⸝⸝ )♡( ⸝⸝⸝•_•⸝⸝⸝ )♡\n( ⸝⸝⸝•_•⸝⸝⸝ )♡( ⸝⸝⸝•_•⸝⸝⸝ )♡", false);
        return;
    } else {
        document.getElementById('errorImage').style.display = "none";
        if (isFirstPasswordCheck) {
            showAlert("密码验证成功！", true);
            isFirstPasswordCheck = false;
            passwordEntered = true; // 密码验证成功后标记为已输入
        }
    }
    // 其他代码保持不变
  const inputLocation = document.getElementById('locationInput').value.trim();
  let locationIndex = locations.indexOf(inputLocation);
  if (locationIndex === -1) {
    const resultContainer = document.createElement('div');
    resultContainer.id = 'matchingListContainer';
    if (inputLocation.length === 1) {
      const firstChar = inputLocation.charAt(0);
      const matchingLocations = locations.filter(location => location.charAt(0) === firstChar);
      if (matchingLocations.length > 0) {
        const matchingList = document.createElement('ul');
        matchingList.id = 'matchingList';
        matchingLocations.forEach((location, index) => {
          const listItem = document.createElement('li');
          listItem.textContent = `${location}(${index + 1})`;
          listItem.addEventListener('click', () => {
            const locationWithoutNumber = location;
            document.getElementById('locationInput').value = locationWithoutNumber;
            findNearestPortal();
          });
          matchingList.appendChild(listItem);
        });
        resultContainer.appendChild(matchingList);
      } else {
        resultContainer.textContent = '没有以该字开头的地点。';
      }
    } else {
      const matchingLocations = locations.filter(location => location.startsWith(inputLocation));
      if (matchingLocations.length > 0) {
        const matchingList = document.createElement('ul');
        matchingList.id = 'matchingList';
        matchingLocations.forEach((location, index) => {
          const listItem = document.createElement('li');
          listItem.textContent = `${location}(${index + 1})`;
          listItem.addEventListener('click', () => {
            const locationWithoutNumber = location;
            document.getElementById('locationInput').value = locationWithoutNumber;
            findNearestPortal();
          });
          matchingList.appendChild(listItem);
        });
        resultContainer.appendChild(matchingList);
      } else {
        resultContainer.textContent = '没有匹配的地点。';
      }
    }
    const result = document.getElementById('resultBox');
    result.innerHTML = '';
    result.appendChild(resultContainer);
    return;
  }
  const selectedPortalType = document.getElementById('portalTypeMenu').value;
  let searchLocations;
  if (selectedPortalType === 'portalOne') {
    searchLocations = portalsOne;
  } else if (selectedPortalType === 'portalTwo') {
    searchLocations = portalsTwo;
  }
  let nearestPortal = null;
  let minDistance = Infinity;
  for (const portal of searchLocations) {
    let portalLocationIndex = locations.indexOf(portal);
    const distance = Math.abs(portalLocationIndex - locationIndex);
    if (distance < minDistance) {
      minDistance = distance;
      nearestPortal = portal;
    }
  }
  let nearestCustomPortal = null;
  let minCustomDistance = Infinity;
  for (const portal of customPortals) {
    let portalLocationIndex = locations.indexOf(portal);
    const distance = Math.abs(portalLocationIndex - locationIndex);
    if (distance < minCustomDistance) {
      minCustomDistance = distance;
      nearestCustomPortal = portal;
    }
  }
  const resultDiv = document.getElementById('resultBox');
  resultDiv.innerHTML = '';
if (nearestPortal || nearestCustomPortal) {
    const portalResultDiv = document.createElement('div');
    portalResultDiv.style.backgroundColor = '#e6f7ff';
    const portalResultTextBox = document.createElement('input');
    portalResultTextBox.type = 'text';
    portalResultTextBox.readOnly = true;
    const moveResultTextBox = document.createElement('input');
    moveResultTextBox.type = 'text';
    moveResultTextBox.readOnly = true;
    if (minDistance < minCustomDistance) {
        portalResultTextBox.value = `传送 ${nearestPortal}`;
        const copyButtonForPortal = document.createElement('button');
        copyButtonForPortal.textContent = '复制传送结果';
        copyButtonForPortal.addEventListener('click', () => {
            const textToCopy = `传送 ${nearestPortal}`;
            copyToClipboard(textToCopy);
        });
        const portalResultContainer = document.createElement('div');
        portalResultContainer.className = 'copy-result-container';
        portalResultContainer.appendChild(portalResultTextBox);
        portalResultContainer.appendChild(copyButtonForPortal);
        portalResultDiv.appendChild(portalResultContainer);
    } else {
        portalResultTextBox.value = `仙居瞬移 ${nearestCustomPortal}`;
        const copyButtonForCustomPortal = document.createElement('button');
        copyButtonForCustomPortal.textContent = '复制瞬移结果';
        copyButtonForCustomPortal.addEventListener('click', () => {
            const textToCopy = `仙居瞬移 ${nearestCustomPortal}`;
            copyToClipboard(textToCopy);
        });
        const customPortalResultContainer = document.createElement('div');
        customPortalResultContainer.className = 'copy-result-container';
        customPortalResultContainer.appendChild(portalResultTextBox);
        customPortalResultContainer.appendChild(copyButtonForCustomPortal);
        portalResultDiv.appendChild(customPortalResultContainer);
    }
    moveResultTextBox.value = `移动 ${inputLocation}`;
    const copyButtonForMove = document.createElement('button');
    copyButtonForMove.textContent = '复制移动结果';
    copyButtonForMove.addEventListener('click', () => {
        const textToCopy = `移动 ${inputLocation}`;
        copyToClipboard(textToCopy);
    });
    const moveResultContainer = document.createElement('div');
    moveResultContainer.className = 'copy-result-container';
    moveResultContainer.appendChild(moveResultTextBox);
    moveResultContainer.appendChild(copyButtonForMove);
    portalResultDiv.appendChild(moveResultContainer);
    resultDiv.appendChild(portalResultDiv);
    showAlert("查找成功！已找到相关传送点。", true);
} else {
    resultDiv.innerHTML = '没有找到合适的传送点。';
}
}

function copyToClipboard(text) {
    const textarea = document.createElement('textarea');
    textarea.value = text;
    document.body.appendChild(textarea);
    textarea.select();
    try {
        document.execCommand('copy');
        console.log('已复制到剪贴板');
        showAlert('复制成功：' + text, true);
    } catch (err) {
        console.error('复制失败: ', err);
        showAlert('复制失败：' + text + '，请重试。', false);
    }
    document.body.removeChild(textarea);
}

// 初始化时默认使用传送点一
        switchToPortalOne();
  
    function addCustomPortals() {
    const customInput = document.getElementById('customInput').value.trim();
    if (customInput === "") {
        showAlert("添加内容不能为空，请输入地图名。", false);
        return;
    }
    const customLocations = customInput.split('\n').map(loc => loc.trim()).filter(loc => loc!== '');
    let invalidLocations = [];
    let validLocations = [];
    for (const loc of customLocations) {
        if (!locations.includes(loc)) {
            invalidLocations.push(loc);
        } else if (!customPortals.includes(loc)) {
            customPortals.push(loc);
            validLocations.push(loc);
        }
    }
    if (invalidLocations.length > 0) {
        showAlert(`以下地点不存在：\n${invalidLocations.join('\n')}`, false);
    }
    if (validLocations.length > 0) {
        showAlert(`成功添加以下地图到仙居列表：\n${validLocations.join('\n')}`, true);
    }
}
  </script>
</body>

</html>